<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/BlogSrc/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/BlogSrc/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/BlogSrc/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/BlogSrc/images/logo.svg" color="#222">

<link rel="stylesheet" href="/BlogSrc/css/main.css">


<link rel="stylesheet" href="/BlogSrc/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"llunch4w.github.io","root":"/BlogSrc/","scheme":"Pisces","version":"8.0.0-rc.3","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="^ _ ^">
<meta property="og:type" content="article">
<meta property="og:title" content="2021-09-17-组会">
<meta property="og:url" content="https://llunch4w.github.io/BlogSrc/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/index.html">
<meta property="og:site_name" content="摸鱼的Llunch">
<meta property="og:description" content="^ _ ^">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/1.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/2.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/3.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/4.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/5.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/6.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/7.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/8.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/9.jpg">
<meta property="og:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/10.jpg">
<meta property="article:published_time" content="2021-09-17T05:26:57.000Z">
<meta property="article:modified_time" content="2022-01-10T06:24:58.884Z">
<meta property="article:author" content="Llunch">
<meta property="article:tag" content="组会">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://llunch4w.github.io/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/1.jpg">

<link rel="canonical" href="https://llunch4w.github.io/BlogSrc/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2021-09-17-组会 | 摸鱼的Llunch</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before, .use-motion .logo-line-after {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/BlogSrc/" class="brand" rel="start">
      <i class="logo-line-before"></i>
      <h1 class="site-title">摸鱼的Llunch</h1>
      <i class="logo-line-after"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/BlogSrc/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/BlogSrc/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/BlogSrc/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/BlogSrc/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/BlogSrc/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Overview"><span class="nav-number">1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-11"><span class="nav-number">2.</span> <span class="nav-text">9.11</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Score-Compare"><span class="nav-number">2.1.</span> <span class="nav-text">Score Compare</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Date-Fix"><span class="nav-number">2.2.</span> <span class="nav-text">Date Fix</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Float-Bond-Money-Situation"><span class="nav-number">2.3.</span> <span class="nav-text">Float Bond Money Situation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-12"><span class="nav-number">3.</span> <span class="nav-text">9.12</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-13-9-15"><span class="nav-number">4.</span> <span class="nav-text">9.13 - 9.15</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-16"><span class="nav-number">5.</span> <span class="nav-text">9.16</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Llunch"
      src="/BlogSrc/images/me.jpg">
  <p class="site-author-name" itemprop="name">Llunch</p>
  <div class="site-description" itemprop="description">没有理想的人不伤心</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/BlogSrc/archives/">
        
          <span class="site-state-item-count">100</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/BlogSrc/categories/">
          
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/BlogSrc/tags/">
          
        <span class="site-state-item-count">73</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Llunch4w" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Llunch4w" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://llunch4w.github.io/BlogSrc/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogSrc/images/me.jpg">
      <meta itemprop="name" content="Llunch">
      <meta itemprop="description" content="没有理想的人不伤心">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="摸鱼的Llunch">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2021-09-17-组会
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-17 13:26:57" itemprop="dateCreated datePublished" datetime="2021-09-17T13:26:57+08:00">2021-09-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-10 14:24:58" itemprop="dateModified" datetime="2022-01-10T14:24:58+08:00">2022-01-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/BlogSrc/categories/%E7%BB%84%E4%BC%9A/" itemprop="url" rel="index"><span itemprop="name">组会</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote class="blockquote-center">
<p>^ _ ^ </p>

</blockquote>
<a id="more"></a>

<blockquote>
<p>From 2021-09-11 to 2021-09-17<br>Fix bugs of project(cj_text_analyze)</p>
</blockquote>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/1.jpg" alt></p>
<h1 id="9-11"><a href="#9-11" class="headerlink" title="9.11"></a>9.11</h1><p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/2.jpg" alt></p>
<h2 id="Score-Compare"><a href="#Score-Compare" class="headerlink" title="Score Compare"></a>Score Compare</h2><p>After a token go through the <code>FSM(Finite-State Machine)</code>, process will find out its’ pattern type. There is a one-to-many relationship between morphological types and semantic types.<br>We define features every semantic type should qualify in <code>token_config.py</code>.If the token match a feature which belongs to a semantic,it will get a score added in this semantic.</p>
<p>After semantic score assigned,the process will normalize the score to [0,1], I call the normalized result weight, which means the possibility of the token to have this semantic.</p>
<p>In some situation, this thinking will make some mistake. Because different pattern type will map into the same semantic type.Sometimes, their weight might be same, but the score is different. Usually, we need the high score one to replace the low score one which might firstly be put into the clot chess.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">occupy_token_score = occupy_token.get_score_by_semantic(semantic)</span><br><span class="line">token_weight = token.get_weight_by_semantic(semantic)</span><br><span class="line">token_score = token.get_score_by_semantic(semantic)</span><br><span class="line"><span class="keyword">if</span> occupy_token_weight &gt;= token_weight <span class="keyword">and</span> occupy_token_score &gt;= token_score:</span><br><span class="line">    logger.info(<span class="string">f"占领token【<span class="subst">&#123;occupy_token.value&#125;</span>】语义权重【<span class="subst">&#123;occupy_token_weight&#125;</span>】&gt;= 当前token【<span class="subst">&#123;token.value&#125;</span>】语义权重【<span class="subst">&#123;token_weight&#125;</span>】;尝试不摆放<span class="subst">&#123;token&#125;</span>"</span>)</span><br><span class="line">    logger.info(<span class="string">f"占领token【<span class="subst">&#123;occupy_token.value&#125;</span>】语义得分【<span class="subst">&#123;occupy_token_score&#125;</span>】&gt;= 当前token【<span class="subst">&#123;token.value&#125;</span>】语义得分【<span class="subst">&#123;token_score&#125;</span>】;尝试不摆放<span class="subst">&#123;token&#125;</span>"</span>)</span><br><span class="line">    next_state = copy.deepcopy(cur_state)</span><br><span class="line">    next_state.discard_token(token)</span><br><span class="line">    logger.info(<span class="string">f"新的元素棋盘放入队列:<span class="subst">&#123;next_state&#125;</span>"</span>)</span><br><span class="line">    state_queue.put([-next_state.get_score(), next_state])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    logger.info(<span class="string">f"摆放【<span class="subst">&#123;token.value&#125;</span>】替换【<span class="subst">&#123;occupy_token.value&#125;</span>】"</span>)</span><br><span class="line">    next_state = copy.deepcopy(cur_state)</span><br><span class="line">    next_state.pos_token(index, token)</span><br><span class="line">    logger.info(<span class="string">f"新的元素棋盘放入队列:<span class="subst">&#123;next_state&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/3.jpg" alt></p>
<h2 id="Date-Fix"><a href="#Date-Fix" class="headerlink" title="Date Fix"></a>Date Fix</h2><p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/4.jpg" alt> </p>
<h2 id="Float-Bond-Money-Situation"><a href="#Float-Bond-Money-Situation" class="headerlink" title="Float Bond Money Situation"></a>Float Bond Money Situation</h2><p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/5.jpg" alt></p>
<h1 id="9-12"><a href="#9-12" class="headerlink" title="9.12"></a>9.12</h1><p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/6.jpg" alt></p>
<p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/7.jpg" alt></p>
<p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/8.jpg" alt></p>
<h1 id="9-13-9-15"><a href="#9-13-9-15" class="headerlink" title="9.13 - 9.15"></a>9.13 - 9.15</h1><p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/9.jpg" alt></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">@File    :   merge_strategy.py</span></span><br><span class="line"><span class="string">@Time    :   2021/09/14 07:26:21</span></span><br><span class="line"><span class="string">@Author  :   LuckyQ</span></span><br><span class="line"><span class="string">@Version :   1.0</span></span><br><span class="line"><span class="string">@Desc    :   Token 合并策略</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> token_evaluate <span class="keyword">import</span> has_semantic</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> cj_token <span class="keyword">import</span> Token</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MergeStrategy</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, token_list)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 交易关键词合并策略，形如“关键词1:xx,关键词2:xx”的(2|4|6|8)个Token进行合并</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DealKeywordMerge</span><span class="params">(MergeStrategy)</span>:</span></span><br><span class="line">    keyword_list = [<span class="string">"买"</span>, <span class="string">"卖"</span>]</span><br><span class="line">    obj_semantic = [<span class="string">"Deal_Company"</span>, <span class="string">"Real_Deal_Op_Name"</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, token_list)</span>:</span></span><br><span class="line">        res_list = []</span><br><span class="line">        i, n = <span class="number">0</span>, len(token_list)</span><br><span class="line">        <span class="keyword">while</span> i &lt; n:</span><br><span class="line">            token = token_list[i]</span><br><span class="line">            token_value = token.value</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self._is_contain_keyword(token_value):</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                res_list.append(token)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">for</span> semantic <span class="keyword">in</span> self.obj_semantic:</span><br><span class="line">                <span class="keyword">if</span> has_semantic(token, semantic):</span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                res_list.append(token)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># 从 i 偶数间隔往下寻找可以合并的关键词组</span></span><br><span class="line">            start = i</span><br><span class="line">            <span class="keyword">assert</span> i+<span class="number">1</span> &lt; n</span><br><span class="line">            merge_value_list = [token_list[i].value, token_list[i+<span class="number">1</span>].value]</span><br><span class="line">            i += <span class="number">2</span></span><br><span class="line">            <span class="keyword">while</span> i+<span class="number">1</span> &lt; n:</span><br><span class="line">                token = token_list[i]</span><br><span class="line">                token_value = token.value</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> self._is_contain_keyword(token_value):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                flag = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">for</span> semantic <span class="keyword">in</span> self.obj_semantic:</span><br><span class="line">                    <span class="keyword">if</span> has_semantic(token, semantic):</span><br><span class="line">                        flag = <span class="literal">True</span></span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">                merge_value_list.extend([token_list[i].value, token_list[i+<span class="number">1</span>].value])</span><br><span class="line">                i += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">            new_token = Token(value=merge_value_list, pattern_type=<span class="string">"Keyword_Compose"</span>)</span><br><span class="line">            new_token.row = token_list[start].row</span><br><span class="line">            res_list.append(new_token)</span><br><span class="line">            <span class="comment"># 找到一个这样的单词组就退出循环</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; n:</span><br><span class="line">            res_list.append(token_list[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res_list</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 某字符串是否包含 keyword_list 中的关键词</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_is_contain_keyword</span><span class="params">(self, s)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> keyword <span class="keyword">in</span> self.keyword_list:</span><br><span class="line">                <span class="keyword">if</span> keyword <span class="keyword">in</span> s:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多个同态要素合并策略</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SemanticSimilaryMerge</span><span class="params">(MergeStrategy)</span>:</span></span><br><span class="line">    semantic_list = [<span class="string">"Product"</span>, <span class="string">"Bond_Money"</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, token_list)</span>:</span></span><br><span class="line">        res_list = []</span><br><span class="line">        i, n = <span class="number">0</span>, len(token_list)</span><br><span class="line">        start, end = <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; n<span class="number">-1</span>:</span><br><span class="line">            token, next_token = token_list[i], token_list[i+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self._is_semantic_seq(token, next_token):</span><br><span class="line">                res_list.append(token)</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            start = i</span><br><span class="line">            value_list = [token.value, next_token.value]</span><br><span class="line">            i += <span class="number">2</span></span><br><span class="line">            <span class="keyword">while</span> i &lt; n - <span class="number">1</span>:</span><br><span class="line">                token, next_token = token_list[i], token_list[i+<span class="number">1</span>]</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> self._is_semantic_seq(token, next_token):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                value_list.extend([token.value, next_token.value])</span><br><span class="line">                i += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">            new_token = Token(value=value_list, pattern_type=<span class="string">"Element_Compose"</span>)</span><br><span class="line">            new_token.row = token_list[start].row</span><br><span class="line">            res_list.append(new_token)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; n:</span><br><span class="line">            res_list.append(token_list[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res_list</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_is_semantic_seq</span><span class="params">(self, token, next_token)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> has_semantic(token, self.semantic_list[<span class="number">0</span>]) <span class="keyword">and</span> has_semantic(next_token, self.semantic_list[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同义词、词补充合并策略</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SupplyMerge</span><span class="params">(MergeStrategy)</span>:</span></span><br><span class="line">    sequence_list = [[<span class="string">"Real_Deal_Op_Name"</span>, <span class="string">"Deal_Company"</span>], [<span class="string">"Real_Deal_Op_Name"</span>, <span class="string">"Op_Dealer_No"</span>], \</span><br><span class="line">                    [<span class="string">"Deal_Company"</span>, <span class="string">"Dealer_No"</span>]]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, token_list)</span>:</span></span><br><span class="line">        res_list = []</span><br><span class="line">        i, n = <span class="number">0</span>, len(token_list)</span><br><span class="line">        <span class="keyword">while</span> i &lt; n:</span><br><span class="line">            match_seq = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">for</span> sequence <span class="keyword">in</span> self.sequence_list:</span><br><span class="line">                <span class="keyword">if</span> i + len(sequence) - <span class="number">1</span> &gt;= n:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                flag = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, len(sequence)):</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> has_semantic(token_list[i+j], sequence[j]):</span><br><span class="line">                        flag = <span class="literal">False</span></span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                <span class="comment"># 有一个满足条件的语义序列，则将它们合并</span></span><br><span class="line">                <span class="keyword">if</span> flag:</span><br><span class="line">                    value_list = [token_list[i].value <span class="keyword">for</span> i <span class="keyword">in</span> range(i,i+len(sequence))]</span><br><span class="line">                    new_token = Token(value=value_list, pattern_type=<span class="string">"Similary_Compose"</span>)</span><br><span class="line">                    new_token.row = token_list[i].row</span><br><span class="line">                    res_list.append(new_token)</span><br><span class="line">                    i += len(sequence)</span><br><span class="line">                    match_seq = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> match_seq:</span><br><span class="line">                res_list.append(token_list[i])</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res_list</span><br></pre></td></tr></table></figure>

<h1 id="9-16"><a href="#9-16" class="headerlink" title="9.16"></a>9.16</h1><p><img src="/2021/09/17/2021-09-17-%E7%BB%84%E4%BC%9A/10.jpg" alt></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果当前棋盘中相邻两行差异太大的话，将下一行合并到这一行</span></span><br><span class="line">        fix_cloth_chess = []</span><br><span class="line">        fix_orders = []</span><br><span class="line">        <span class="comment"># 将交集小于 max_dis 的相邻两行进行合并</span></span><br><span class="line">        max_dis = <span class="number">2</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(self.cloth_chess):</span><br><span class="line">            row = self.cloth_chess[i]</span><br><span class="line">            <span class="keyword">if</span> i == len(self.cloth_chess) - <span class="number">1</span>:</span><br><span class="line">                fix_cloth_chess.append(row)</span><br><span class="line">                fix_orders.append(self.orders[i])</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            cur_element_list = self.orders[i]</span><br><span class="line">            next_element_list = self.orders[i+<span class="number">1</span>]</span><br><span class="line">            element_dis = len(set(cur_element_list).intersection(set(next_element_list)))</span><br><span class="line">            <span class="keyword">if</span> element_dis &lt;= max_dis:</span><br><span class="line">                fix_order = copy.deepcopy(cur_element_list)</span><br><span class="line">                <span class="keyword">for</span> ele <span class="keyword">in</span> next_element_list:</span><br><span class="line">                    <span class="keyword">if</span> ele <span class="keyword">not</span> <span class="keyword">in</span> fix_order:</span><br><span class="line">                        fix_order.append(ele)</span><br><span class="line">                new_row = copy.deepcopy(row)</span><br><span class="line">                <span class="keyword">for</span> i, col <span class="keyword">in</span> enumerate(self.cloth_chess[i+<span class="number">1</span>]):</span><br><span class="line">                    <span class="keyword">if</span> col != <span class="literal">None</span> <span class="keyword">and</span> row[i] == <span class="literal">None</span>:</span><br><span class="line">                        new_row[i] = copy.deepcopy(col)</span><br><span class="line">                fix_cloth_chess.append(new_row)</span><br><span class="line">                fix_orders.append(fix_order)</span><br><span class="line">                i += <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                fix_cloth_chess.append(row)</span><br><span class="line">                fix_orders.append(self.orders[i])</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        self.cloth_chess = fix_cloth_chess</span><br><span class="line">        self.orders = fix_orders</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/BlogSrc/tags/%E7%BB%84%E4%BC%9A/" rel="tag"># 组会</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/BlogSrc/2021/09/17/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD-%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95/" rel="prev" title="人工智能-搜索算法">
      <i class="fa fa-chevron-left"></i> 人工智能-搜索算法
    </a></div>
      <div class="post-nav-item">
    <a href="/BlogSrc/2022/01/10/hello-world/" rel="next" title="Hello World">
      Hello World <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81MDY4OC8yNzE3MQ"></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Llunch</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/BlogSrc/lib/anime.min.js"></script>
  <script src="/BlogSrc/lib/velocity/velocity.min.js"></script>
  <script src="/BlogSrc/lib/velocity/velocity.ui.min.js"></script>

<script src="/BlogSrc/js/utils.js"></script>

<script src="/BlogSrc/js/motion.js"></script>


<script src="/BlogSrc/js/next-boot.js"></script>


  




  
<script src="/BlogSrc/js/local-search.js"></script>













  

  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

<script src="/BlogSrc/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/BlogSrc/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
